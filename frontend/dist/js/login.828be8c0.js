"use strict";(self["webpackChunkinventorsoft_vue_2022"]=self["webpackChunkinventorsoft_vue_2022"]||[]).push([[535],{2864:function(e,s,t){t.r(s),t.d(s,{default:function(){return y}});var a=function(){var e=this,s=e._self._c;return s("div",{staticClass:"login-page-container relative"},[s("div",{staticClass:"login-page-shader"},[s("div",{staticClass:"w-1/5"},[s("div",{staticClass:"login-title"},[e._v(" Academy Application ")]),s("div",{staticClass:"login-form-container"},[e._m(0),s("LoginForm")],1)])]),e._m(1)])},r=[function(){var e=this,s=e._self._c;return s("div",{staticClass:"flex justify-center mb-2"},[s("img",{staticClass:"login-form-logo",attrs:{src:t(5722),alt:"main_logo"}})])},function(){var e=this,s=e._self._c;return s("div",{staticClass:"login-link absolute bottom-0 right-0"},[e._v(" Copyright Â©"),s("a",{staticClass:"text-primary-700 text-xs font-semibold mx-1",attrs:{href:"https://inventorsoft.co/"}},[e._v("InventorSoft")])])}],o=t(4259),i=function(){var e=this,s=e._self._c;return s("div",[s("ValidationObserver",{scopedSlots:e._u([{key:"default",fn:function({handleSubmit:t}){return[s("form",{on:{submit:function(s){return s.preventDefault(),t(e.onSubmit)}}},[s("div",{staticClass:"mb-4"},[s("BaseInput",{attrs:{type:"text",label:"Email",vid:"email",placeholder:"aaa@gmail.com"},model:{value:e.formData.email,callback:function(s){e.$set(e.formData,"email",s)},expression:"formData.email"}})],1),e.isLoginPage?s("div",[s("BaseInput",{attrs:{type:"password",label:"Password",vid:"text",placeholder:"qwe123"},model:{value:e.formData.password,callback:function(s){e.$set(e.formData,"password",s)},expression:"formData.password"}}),s("p",{staticClass:"link",on:{click:e.goToResetPage}},[e._v(" Forgot password? ")]),s("div",{staticClass:"flex justify-center"},[s("BaseButton",{staticClass:"my-3",attrs:{loading:e.isDataLoading,type:"submit"}},[e._v(" Submit ")])],1)],1):e._e()])]}}])}),e.isLoginPage?e._e():s("div",[s("BaseButton",{on:{click:e.resetPasswordOnEmail}},[e._v(" Reset Password ")]),s("p",{staticClass:"link",on:{click:e.goToLoginPage}},[e._v(" Log in page ")])],1)],1)},n=[],l=t(5708),c=t(4146),d=t(9046),m=t(3822),g=t(4028),u={name:"LoginForm",components:{ValidationObserver:l._j,BaseButton:c.Z,BaseInput:d.Z},data:()=>({formData:{email:"",password:""},errorHandler:{isError:!1,message:""},isLoginPage:!0,isDataLoading:!1,errorResetHandler:{isError:!1,message:""}}),computed:{...(0,m.Se)("user",["user"])},methods:{...(0,m.nv)("user",["setUser","logoutUser"]),async onSubmit(){const e=(0,g.v0)();this.isDataLoading=!0;try{const{user:s}=await(0,g.e5)(e,this.formData.email,this.formData.password),{accessToken:t,email:a}=s,r=await(0,o.AW)(t),i=r.find((e=>e.email===a));localStorage.setItem("accessToken",t),localStorage.setItem("email",a),localStorage.setItem("user",JSON.stringify(i)),this.setUser(i),this.errorHandler.isError=!1,this.errorHandler.message="",this.isDataLoading=!1,this.$router.push({name:"courses-dashboard"})}catch(s){switch(this.errorHandler.isError=!0,this.isDataLoading=!1,s.code){case"auth/user-not-found":this.errorHandler.message="Invalid email or password";break;case"auth/wrong-password":this.errorHandler.message="Invalid email or password";break;case"auth/invalide-email":this.errorHandler.message="Invalid email";break;default:this.errorHandler.message=s.code}this.$store.dispatch("toast/show",{message:this.errorHandler.message,type:"error"},{root:!0}),this.logoutUser()}},logout(){this.logoutUser()},resetPasswordOnEmail(){this.isLoginPage=!1,this.errorResetHandler.message="",this.errorResetHandler.isError=!1;const e=(0,g.v0)();(0,g.LS)(e,this.formData.email).then((e=>(this.isLoginPage=!0,this.$store.dispatch("toast/show",{message:"Check your email for letter",type:"success"},{root:!0}),e))).catch((e=>{"auth/user-not-found"==e.code?(this.isLoginPage=!0,this.$store.dispatch("toast/show",{message:"Check your email for letter",type:"success"},{root:!0})):("auth/invalid-email"===e.code?this.errorResetHandler.message="Invalide email":this.errorResetHandler.message=e.code,this.errorResetHandler.isError=!0,this.$store.dispatch("toast/show",{message:this.errorResetHandler.message,type:"error"},{root:!0}))}))},goToLoginPage(){this.isLoginPage=!0,this.errorResetHandler.message=""},goToResetPage(){this.isLoginPage=!1,this.errorHandler.message=""}}},h=u,f=t(1001),p=(0,f.Z)(h,i,n,!1,null,"5fee18e6",null),v=p.exports,w=t(7162),_={name:"LoginView",components:{LoginForm:v},data(){return{initialLoading:!0}},computed:{...(0,m.Se)("user",["user"])},async mounted(){const e=localStorage.getItem("accessToken");if(e){const s=await this.isTokenAlive(e);if(s){const s=localStorage.getItem("email"),t=await(0,o.AW)(e),a=t.find((e=>e.email===s));this.setUser(a),localStorage.setItem("user",JSON.stringify(a)),this.$router.push({name:w.Kl})}}this.initialLoading=!1},methods:{...(0,m.nv)("user",["setUser"]),async isTokenAlive(e){try{return await(0,o.AW)(e),!0}catch(s){return!1}}}},b=_,k=(0,f.Z)(b,a,r,!1,null,"45c40731",null),y=k.exports}}]);
//# sourceMappingURL=login.828be8c0.js.map